-- Decompiled using luadec 2.2 rev: 895d923 for Lua 5.1 from https://github.com/viruscamp/luadec
-- Command line: lua\!InfrastructureShared\!#ALFExploitScriptMaliciousSerializedObjectB\1.luac 

-- params : ...
-- function num : 0
local l_0_0 = function(l_1_0)
  -- function num : 0_0
  local l_1_1 = (string.gsub)(l_1_0, "([^%z])%z", "%1")
  local l_1_2 = {}
  l_1_2["%2b"] = "+"
  l_1_2["%2B"] = "+"
  l_1_2["%2d"] = "+"
  l_1_2["%2D"] = "+"
  l_1_2["-"] = "+"
  l_1_2["%2f"] = "/"
  l_1_2["%2F"] = "/"
  l_1_2["%5f"] = "/"
  l_1_2["%5F"] = "/"
  l_1_2._ = "/"
  l_1_2["%3d"] = "="
  l_1_2["%3D"] = "="
  l_1_2["&#34;"] = "\""
  l_1_2["&gt;"] = ">"
  l_1_2["&lt;"] = "<"
  local l_1_3 = string.gsub
  local l_1_4 = l_1_1
  local l_1_5 = "([%%&#%-_][%%&#]?[235gl]?[4bBdDfFt]?;?)"
  do
    local l_1_6 = l_1_2
    do return l_1_3(l_1_4, l_1_5, l_1_6) end
    -- DECOMPILER ERROR at PC29: Confused about usage of register R4 for local variables in 'ReleaseLocals'

  end
end

;
(mp.readprotection)(false)
local l_0_1 = (mp.readfile)(0, (mp.getfilesize)() or 0)
;
(mp.readprotection)(true)
if not l_0_1 then
  return mp.CLEAN
end
local l_0_2 = (string.match)(l_0_1, "(H4sIA[^\"]-)%%22")
if not l_0_2 then
  return mp.CLEAN
end
;
(mp.vfo_add_buffer)(l_0_2, "[CompressedDataTable_Raw]", mp.ADD_VFO_TAKE_ACTION_ON_DAD)
l_0_2 = l_0_0(l_0_2)
;
(mp.vfo_add_buffer)((MpCommon.Base64Decode)(l_0_2), "[CompressedDataTable_Decoded]", mp.ADD_VFO_TAKE_ACTION_ON_DAD)
return mp.INFECTED

