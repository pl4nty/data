-- Decompiled using luadec 2.2 rev: 895d923 for Lua 5.1 from https://github.com/viruscamp/luadec
-- Command line: lua\!InfrastructureShared\2c3b33687b1e5\1.luac 

-- params : ...
-- function num : 0
local l_0_0 = ((bm.get_imagepath)()):lower()
local l_0_1 = contains
local l_0_2 = l_0_0
local l_0_3 = {}
-- DECOMPILER ERROR at PC10: No list found for R3 , SetList fails

-- DECOMPILER ERROR at PC14: Overwrote pending register: R1 in 'AssignReg'

-- DECOMPILER ERROR at PC15: Overwrote pending register: R1 in 'AssignReg'

if l_0_1 then
  return l_0_1
end
-- DECOMPILER ERROR at PC17: Overwrote pending register: R1 in 'AssignReg'

-- DECOMPILER ERROR at PC20: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC21: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC24: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC25: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC26: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC27: Overwrote pending register: R4 in 'AssignReg'

-- DECOMPILER ERROR at PC27: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC28: Overwrote pending register: R5 in 'AssignReg'

if l_0_3 then
  l_0_3 = l_0_3("conhost.exe", "werfault.exe")
  -- DECOMPILER ERROR at PC30: Overwrote pending register: R1 in 'AssignReg'

  -- DECOMPILER ERROR at PC31: Overwrote pending register: R2 in 'AssignReg'

else
  l_0_3 = this_sigattrlog
  l_0_3 = l_0_3[2]
  l_0_3 = l_0_3.matched
  if l_0_3 then
    l_0_3 = this_sigattrlog
    l_0_3 = l_0_3[2]
    l_0_3 = l_0_3.utf8p1
    l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
    -- DECOMPILER ERROR at PC44: Overwrote pending register: R1 in 'AssignReg'

    -- DECOMPILER ERROR at PC45: Overwrote pending register: R2 in 'AssignReg'

  else
    l_0_3 = this_sigattrlog
    l_0_3 = l_0_3[3]
    l_0_3 = l_0_3.matched
    if l_0_3 then
      l_0_3 = this_sigattrlog
      l_0_3 = l_0_3[3]
      l_0_3 = l_0_3.utf8p1
      l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
      -- DECOMPILER ERROR at PC58: Overwrote pending register: R1 in 'AssignReg'

      -- DECOMPILER ERROR at PC59: Overwrote pending register: R2 in 'AssignReg'

    else
      l_0_3 = this_sigattrlog
      l_0_3 = l_0_3[4]
      l_0_3 = l_0_3.matched
      if l_0_3 then
        l_0_3 = this_sigattrlog
        l_0_3 = l_0_3[4]
        l_0_3 = l_0_3.utf8p1
        l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
        -- DECOMPILER ERROR at PC72: Overwrote pending register: R1 in 'AssignReg'

        -- DECOMPILER ERROR at PC73: Overwrote pending register: R2 in 'AssignReg'

      else
        l_0_3 = this_sigattrlog
        l_0_3 = l_0_3[5]
        l_0_3 = l_0_3.matched
        if l_0_3 then
          l_0_3 = this_sigattrlog
          l_0_3 = l_0_3[5]
          l_0_3 = l_0_3.utf8p1
          l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
          -- DECOMPILER ERROR at PC86: Overwrote pending register: R1 in 'AssignReg'

          -- DECOMPILER ERROR at PC87: Overwrote pending register: R2 in 'AssignReg'

        else
          l_0_3 = this_sigattrlog
          l_0_3 = l_0_3[6]
          l_0_3 = l_0_3.matched
          if l_0_3 then
            l_0_3 = this_sigattrlog
            l_0_3 = l_0_3[6]
            l_0_3 = l_0_3.utf8p1
            l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
            -- DECOMPILER ERROR at PC100: Overwrote pending register: R1 in 'AssignReg'

          else
            l_0_3 = this_sigattrlog
            l_0_3 = l_0_3[7]
            l_0_3 = l_0_3.matched
            if l_0_3 then
              l_0_3 = this_sigattrlog
              l_0_3 = l_0_3[7]
              l_0_3 = l_0_3.utf8p1
              l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
              -- DECOMPILER ERROR at PC113: Overwrote pending register: R1 in 'AssignReg'

            else
              l_0_3 = this_sigattrlog
              l_0_3 = l_0_3[8]
              l_0_3 = l_0_3.matched
              if l_0_3 then
                l_0_3 = this_sigattrlog
                l_0_3 = l_0_3[8]
                l_0_3 = l_0_3.utf8p1
                l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
                -- DECOMPILER ERROR at PC126: Overwrote pending register: R1 in 'AssignReg'

              else
                l_0_3 = this_sigattrlog
                l_0_3 = l_0_3[9]
                l_0_3 = l_0_3.matched
                if l_0_3 then
                  l_0_3 = this_sigattrlog
                  l_0_3 = l_0_3[9]
                  l_0_3 = l_0_3.utf8p1
                  l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
                  -- DECOMPILER ERROR at PC139: Overwrote pending register: R1 in 'AssignReg'

                else
                  l_0_3 = this_sigattrlog
                  l_0_3 = l_0_3[10]
                  l_0_3 = l_0_3.matched
                  if l_0_3 then
                    l_0_3 = this_sigattrlog
                    l_0_3 = l_0_3[10]
                    l_0_3 = l_0_3.utf8p1
                    l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
                    -- DECOMPILER ERROR at PC152: Overwrote pending register: R1 in 'AssignReg'

                  else
                    l_0_3 = this_sigattrlog
                    l_0_3 = l_0_3[11]
                    l_0_3 = l_0_3.matched
                    -- DECOMPILER ERROR at PC159: Overwrote pending register: R2 in 'AssignReg'

                    if l_0_3 then
                      l_0_3 = this_sigattrlog
                      l_0_3 = l_0_3[11]
                      l_0_3 = l_0_3.utf8p2
                      l_0_3 = l_0_3(l_0_3, ".home=.* start")
                      if l_0_3 then
                        l_0_3 = this_sigattrlog
                        l_0_3 = l_0_3[11]
                        l_0_3 = l_0_3.utf8p1
                        l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
                        -- DECOMPILER ERROR at PC174: Overwrote pending register: R1 in 'AssignReg'

                      end
                    else
                      l_0_3 = this_sigattrlog
                      l_0_3 = l_0_3[12]
                      l_0_3 = l_0_3.matched
                      if l_0_3 then
                        l_0_3 = this_sigattrlog
                        l_0_3 = l_0_3[12]
                        l_0_3 = l_0_3.utf8p2
                        l_0_3 = l_0_3(l_0_3, ".home=.* start")
                        if l_0_3 then
                          l_0_3 = this_sigattrlog
                          l_0_3 = l_0_3[12]
                          l_0_3 = l_0_3.utf8p1
                          l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
                          -- DECOMPILER ERROR at PC195: Overwrote pending register: R1 in 'AssignReg'

                        end
                      else
                        l_0_3 = this_sigattrlog
                        l_0_3 = l_0_3[13]
                        l_0_3 = l_0_3.matched
                        -- DECOMPILER ERROR at PC202: Overwrote pending register: R2 in 'AssignReg'

                        if l_0_3 then
                          l_0_3 = this_sigattrlog
                          l_0_3 = l_0_3[13]
                          l_0_3 = l_0_3.utf8p1
                          l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
                          -- DECOMPILER ERROR at PC209: Overwrote pending register: R1 in 'AssignReg'

                        else
                          l_0_3 = this_sigattrlog
                          l_0_3 = l_0_3[14]
                          l_0_3 = l_0_3.matched
                          if l_0_3 then
                            l_0_3 = this_sigattrlog
                            l_0_3 = l_0_3[14]
                            l_0_3 = l_0_3.utf8p1
                            l_0_3 = l_0_3(l_0_3, "([^\\]+)$")
                            -- DECOMPILER ERROR at PC222: Overwrote pending register: R1 in 'AssignReg'

                          end
                        end
                      end
                    end
                  end
                end
              end
            end
          end
        end
      end
    end
  end
end
if not l_0_1 then
  l_0_3 = mp
  l_0_3 = l_0_3.CLEAN
  return l_0_3
end
l_0_3 = nil
if l_0_2 then
  l_0_3 = GetPidFromParentImagePath(l_0_1)
else
  local l_0_4 = (bm.get_current_process_startup_info)()
  if l_0_4 and l_0_4.ppid then
    l_0_3 = l_0_4.ppid
  end
end
do
  if not l_0_3 then
    return mp.CLEAN
  end
  local l_0_5 = {}
  l_0_5.AppName = l_0_1
  l_0_5.Pid = l_0_3
  l_0_5.AppCategory = "PFServers"
  l_0_5.WebAppName = getWebApplicationType(l_0_3)
  l_0_5.Score = 0
  if not (MpCommon.DoesProcessHaveAttribute)(l_0_3, "PFApp_Parent") then
    local l_0_6, l_0_7 = pcall(MpCommon.AddProcessAttribute, l_0_3, "PFApp_Parent", safeJsonSerialize(l_0_5), true)
    if not l_0_6 then
      local l_0_8 = {}
      l_0_8.err = l_0_7
      l_0_8.AttributeValue = l_0_5
      l_0_8.SignatureName = "PFA_Parent.A"
      l_0_8.ProcessName = l_0_0
      ;
      (bm.trigger_sig)("ProcAttribError", safeJsonSerialize(l_0_8))
      return mp.CLEAN
    end
  end
  do
    return mp.CLEAN
  end
end

